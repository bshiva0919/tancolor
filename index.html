<!DOCTYPE html>
<html>
 
<head>
  <meta charset="UTF-8">
  <title>Demo | imageshack.js</title>
  <meta name="description"
    content="Demo | imageshack.js">
  <link href="style.css" rel="stylesheet">
  <!--[if IE]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>
 
<body>

<div id="container">
  <img id="test" src="obama.jpg" alt="I am Obama">
  <img id="test2" src="obama.jpg" alt="I am Obama">
  <img id="test3" src="obama.jpg" alt="I am Obama">
  <img id="test4" src="obama.jpg" alt="I am Obama">
</div>
 
<!-- java script -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script>
  (function ( $ ) {
      
      $.fn.tancolor = function( options ) {
          
          var settings = $.extend({
              color: "#556b2f",
              backgroundColor: "white"
          }, options );

          var canvas = document.createElement("canvas");
          canvas.width = $(this).width();
          canvas.height = $(this).height();
          var img = document.getElementById($(this).attr("id"));
          canvas.getContext("2d").drawImage(img, 0, 0);
          var context = canvas.getContext('2d');
          context.drawImage(img, 0 , 0);
          $(this).replaceWith(canvas);

          var imageData = context.getImageData(0, 0, img.width, img.height);
          var data = imageData.data;
          for(var i = 0; i < data.length; i += 4) {
              var brightness = 0.34 * data[i] + 0.5 * data[i + 1] + 0.16 * data[i + 2];
              //var brightness = 1.0 * data[i] + 1.0 * data[i + 1] + 1.0 * data[i + 2];
              // red
              data[i] = brightness;
              // green
              data[i + 1] = brightness;
              // blue
              data[i + 2] = 255 * brightness;
          }

          // overwrite original image
          context.putImageData(imageData, 0, 0);
      };
  }(jQuery));

  $("#test").tancolor();
  $("#test2").tancolor();
  $("#test4").tancolor();
</script>
</body>
</html>
